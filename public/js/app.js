(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.app = f()}})(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({"./src/js/app.js":[function(_dereq_,module,exports){
"use strict";

var _createClass = (function () { function defineProperties(target, props) { for (var key in props) { var prop = props[key]; prop.configurable = true; if (prop.value) prop.writable = true; } Object.defineProperties(target, props); } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();

var _classCallCheck = function (instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } };

//const test_url = "https://medium.com/playwell/no-mans-sky-and-the-beautiful-return-to-the-weird-81343f2aad37/";

var SuperSearchLine = (function () {
	function SuperSearchLine(superSearchLineNode) {
		_classCallCheck(this, SuperSearchLine);

		// Устанавливаем базовые переменные
		this.remote = "http://super-analytics.com/";

		this.id = superSearchLineNode.getAttribute("id");
		this.baseClass = "super-search-line";
		this.baseClassSelector = "." + this.baseClass;
		this.urlPattern = new RegExp(/(https?:\/\/)?((?:www\.)?[-a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,6}\b)([-a-zA-Z0-9@:%_\+.~#?&//=]*)/);

		// Определяем элементы
		this.superSearchLineForm = superSearchLineNode.querySelector(this.baseClassSelector + "__form");
		this.superSearchLineInput = superSearchLineNode.querySelector(this.baseClassSelector + "__input");
		this.superSearchLineReset = superSearchLineNode.querySelector(this.baseClassSelector + "__reset");
		this.superSearchLineButton = superSearchLineNode.querySelector(this.baseClassSelector + "__button");
		// Навешиваем события
		this.superSearchLineInput.addEventListener("change", this.superSearchLineInputHandler.bind(this));
		this.superSearchLineInput.addEventListener("input", this.superSearchLineInputHandler.bind(this));
		this.superSearchLineReset.addEventListener("click", this.superSearchLineResetValue.bind(this));
		this.superSearchLineButton.addEventListener("click", this.superSearchLineSubmit.bind(this));
		this.superSearchLineForm.addEventListener("submit", this.superSearchLineSubmit.bind(this));

		// Создаем элементы для отображения результата

		// Создаем блоки для подсказок
		this.linkTextEl1 = document.createElement("div");
		this.linkTextEl2 = document.createElement("div");
		this.linkTextEl3 = document.createElement("div");

		this.linkTextEl1.classList.add("" + this.baseClass + "__link-text");
		this.linkTextEl2.classList.add("" + this.baseClass + "__link-text");
		this.linkTextEl3.classList.add("" + this.baseClass + "__link-text");

		// Создаем блоки поясняющего текста и сразу считаем ширину т.к. в дальнейшем не меняются
		this.helperEl1 = document.createElement("div");
		this.helperEl2 = document.createElement("div");
		this.helperEl3 = document.createElement("div");

		this.helperEl1.classList.add("" + this.baseClass + "__helper");
		this.helperEl2.classList.add("" + this.baseClass + "__helper");
		this.helperEl3.classList.add("" + this.baseClass + "__helper");

		this.helperEl1.innerHTML = "in <span class=\"" + this.baseClass + "__helper-type\">Phrase Overview</span>";
		this.helperEl2.innerHTML = "in <span class=\"" + this.baseClass + "__helper-type\">Domain Overview</span>";
		this.helperEl3.innerHTML = "in <span class=\"" + this.baseClass + "__helper-type\">URL Overview</span>";

		this.helperStr1Width = this.stringWidthInPX(this.helperEl1);
		this.helperStr2Width = this.stringWidthInPX(this.helperEl2);
		this.helperStr3Width = this.stringWidthInPX(this.helperEl3);
	}

	_createClass(SuperSearchLine, {
		parseUrl: {
			value: function parseUrl(url) {
				return this.urlPattern.test(url);
			}
		},
		superSearchLineResetValue: {
			value: function superSearchLineResetValue() {
				this.superSearchLineInput.value = null;
				//this.superSearchLineInput.change();
				this.superSearchLineReset.classList.add("hidden");
				this.superSearchLineButton.setAttribute("disabled", "disabled");
				var result = this.superSearchLineForm.querySelector(this.baseClassSelector + "__result");
				result && this.superSearchLineForm.removeChild(result);
				//console.log(this.superSearchLineInput.value);
			}
		},
		superSearchLineSubmit: {
			value: function superSearchLineSubmit(e) {
				e.preventDefault();
				var XHR = "onload" in new XMLHttpRequest() ? XMLHttpRequest : XDomainRequest;
				var r = new XHR();
				var data = "formId=" + encodeURIComponent(this.id) + "&query=" + encodeURIComponent(this.superSearchLineInput.value);
				r.open("POST", this.remote);
				r.onload = function (response) {
					console.log(response);
				};
				r.onerror = function (error) {
					console.log("Ошибка: ", error);
				};
				r.send(data);
			}
		},
		superSearchLineResultGenerator: {
			value: function superSearchLineResultGenerator(protocol, domain, query) {
				var inputWidth = this.superSearchLineInput.offsetWidth;

				// Записываем текст в блоки результата и считаем их ширину
				this.linkTextEl1.innerHTML = protocol + domain + query;
				var linkStr1Width = this.stringWidthInPX(this.linkTextEl1);
				this.linkTextEl2.innerHTML = domain;
				var linkStr2Width = this.stringWidthInPX(this.linkTextEl2);
				this.linkTextEl3.innerHTML = domain + query;
				var linkStr3Width = this.stringWidthInPX(this.linkTextEl3);

				var superSearchLineResult = document.createElement("div");
				superSearchLineResult.setAttribute("class", this.baseClass + "__result");
				var helperFixedClass = "" + this.baseClass + "__helper--fixed";

				inputWidth - this.helperStr1Width < linkStr1Width ? this.helperEl1.classList.add(helperFixedClass) : this.helperEl1.classList.remove(helperFixedClass);
				inputWidth - this.helperStr2Width < linkStr2Width ? this.helperEl2.classList.add(helperFixedClass) : this.helperEl2.classList.remove(helperFixedClass);
				inputWidth - this.helperStr3Width < linkStr3Width ? this.helperEl3.classList.add(helperFixedClass) : this.helperEl3.classList.remove(helperFixedClass);

				var superSearchLineItems = "<div class=\"" + this.baseClass + "__item\">\n\t\t\t\t<a href=\"" + this.remote + "?suggestionType=phrase&query=" + (protocol + domain + query) + "\" target=\"_blank\" class=\"" + this.baseClass + "__link\">\n\t\t\t\t\t" + this.nodeToString(this.linkTextEl1) + "\n\t\t\t\t\t" + this.nodeToString(this.helperEl1) + "\n\t\t\t\t</a>\n\t\t\t\t\n\t\t\t</div>\n\t\t\t<div class=\"" + this.baseClass + "__item\">\n\t\t\t\t<a href=\"" + this.remote + "?suggestionType=domain&query=" + domain + "\" target=\"_blank\" class=\"" + this.baseClass + "__link\">\n\t\t\t\t\t" + this.nodeToString(this.linkTextEl2) + "\n\t\t\t\t\t" + this.nodeToString(this.helperEl2) + "\n\t\t\t\t</a>\n\t\t\t</div>\n\t\t\t<div class=\"" + this.baseClass + "__item\">\n\t\t\t\t<a href=\"" + this.remote + "?suggestionType=url&query=" + (domain + query) + "\" target=\"_blank\" class=\"" + this.baseClass + "__link\">\n\t\t\t\t\t" + this.nodeToString(this.linkTextEl3) + "\n\t\t\t\t\t" + this.nodeToString(this.helperEl3) + "\n\t\t\t\t</a>\n\t\t\t</div>";
				superSearchLineResult.innerHTML = superSearchLineItems;
				return superSearchLineResult;
			}
		},
		superSearchLineInputHandler: {
			value: function superSearchLineInputHandler(e) {
				var value = e.target.value;
				var result = this.superSearchLineForm.querySelector(this.baseClassSelector + "__result");
				result && this.superSearchLineForm.removeChild(result);
				if (value !== null && value !== "") {
					this.superSearchLineReset.classList.remove("hidden");
					this.superSearchLineButton.removeAttribute("disabled");
					if (this.parseUrl(value)) {
						var _result = value.match(this.urlPattern);
						var protocol = _result[1];
						var domain = _result[2];
						var query = _result[3];
						var superSearchLineResult = this.superSearchLineResultGenerator(protocol, domain, query);
						console.log(true);
						this.superSearchLineForm.appendChild(superSearchLineResult);
					}
				} else {
					this.superSearchLineReset.classList.add("hidden");
					this.superSearchLineButton.setAttribute("disabled", "disabled");
				}
			}
		},
		stringWidthInPX: {
			value: function stringWidthInPX(el) {
				// дополнительные стили для клона, что бы мир не заметил чуда, и размеры отображались корректно
				var hiddenStyle = "left:-10000px;top:-10000px;height:auto;width:auto;position:absolute;";

				// создаем box элемент
				// для клонирования содержимого из нашего исходного inline блока
				var clone = document.createElement("div");

				// в обязательном порядке копируем стили с исходного элемента,
				// что бы размеры соответствовали исходнику.
				var style = window.getComputedStyle(el, null);
				clone.classList = el.classList;
				for (var i in el.style) {
					try {
						if (el.style[i] != "" && el.style[i].indexOf(":") > 0) {
							clone.style[i] = el.style[i];
						}
					} catch (e) {}
				}

				// устанавливаем стили у клона, дабы он не мозолил глаз.
				// Учитываем, что IE не позволяет напрямую устанавливать значение аттрибута style
				document.all ? clone.style.setAttribute("cssText", hiddenStyle) : clone.setAttribute("style", hiddenStyle);

				clone.innerHTML = el.innerHTML;

				parent.document.body.appendChild(clone);

				var width = clone.clientWidth;
				console.log(width);
				parent.document.body.removeChild(clone);

				return width;
			}
		},
		nodeToString: {
			value: function nodeToString(node) {
				var tmpNode = document.createElement("div");
				tmpNode.appendChild(node.cloneNode(true));
				var str = tmpNode.innerHTML;
				tmpNode = node = null;
				return str;
			}
		}
	});

	return SuperSearchLine;
})();

var init = (function () {
	var superSearchLines = document.querySelectorAll(".super-search-line");
	var i = 0;
	var _iteratorNormalCompletion = true;
	var _didIteratorError = false;
	var _iteratorError = undefined;

	try {
		for (var _iterator = superSearchLines[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {
			var superSearchLine = _step.value;

			superSearchLine.setAttribute("id", "superSeachLine" + i++);
			new SuperSearchLine(superSearchLine);
		}
	} catch (err) {
		_didIteratorError = true;
		_iteratorError = err;
	} finally {
		try {
			if (!_iteratorNormalCompletion && _iterator["return"]) {
				_iterator["return"]();
			}
		} finally {
			if (_didIteratorError) {
				throw _iteratorError;
			}
		}
	}
})(function () {
	document.addEventListener("DOMContentLoaded", init);
});

},{}]},{},["./src/js/app.js"])("./src/js/app.js")
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJjOi9Vc2Vycy9hbGV4ZXkvRG9jdW1lbnRzL0dpdEh1Yi9zZW1ydXNoX3Rlc3Qvc3JjL2pzL2FwcC5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQ0FBLFlBQVksQ0FBQzs7Ozs7Ozs7SUFLUCxlQUFlO0FBRVQsVUFGTixlQUFlLENBRVIsbUJBQW1CLEVBQUU7d0JBRjVCLGVBQWU7OztBQUtuQixNQUFJLENBQUMsTUFBTSxHQUFHLDZCQUE2QixDQUFDOztBQUU1QyxNQUFJLENBQUMsRUFBRSxHQUFHLG1CQUFtQixDQUFDLFlBQVksQ0FBQyxJQUFJLENBQUMsQ0FBQztBQUNqRCxNQUFJLENBQUMsU0FBUyxHQUFHLG1CQUFtQixDQUFDO0FBQ3JDLE1BQUksQ0FBQyxpQkFBaUIsR0FBRyxHQUFHLEdBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQztBQUM1QyxNQUFJLENBQUMsVUFBVSxHQUFHLElBQUksTUFBTSxDQUFDLG9HQUFvRyxDQUFDLENBQUM7OztBQUduSSxNQUFJLENBQUMsbUJBQW1CLEdBQUcsbUJBQW1CLENBQUMsYUFBYSxDQUFDLElBQUksQ0FBQyxpQkFBaUIsR0FBQyxRQUFRLENBQUMsQ0FBQztBQUM5RixNQUFJLENBQUMsb0JBQW9CLEdBQUcsbUJBQW1CLENBQUMsYUFBYSxDQUFDLElBQUksQ0FBQyxpQkFBaUIsR0FBQyxTQUFTLENBQUMsQ0FBQztBQUNoRyxNQUFJLENBQUMsb0JBQW9CLEdBQUcsbUJBQW1CLENBQUMsYUFBYSxDQUFDLElBQUksQ0FBQyxpQkFBaUIsR0FBQyxTQUFTLENBQUMsQ0FBQztBQUNoRyxNQUFJLENBQUMscUJBQXFCLEdBQUcsbUJBQW1CLENBQUMsYUFBYSxDQUFDLElBQUksQ0FBQyxpQkFBaUIsR0FBQyxVQUFVLENBQUMsQ0FBQzs7QUFFbEcsTUFBSSxDQUFDLG9CQUFvQixDQUFDLGdCQUFnQixDQUFDLFFBQVEsRUFBQyxJQUFJLENBQUMs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QUMsQ0FBQzs7QUFFeEMsUUFBSSxLQUFLLEdBQUcsS0FBSyxDQUFDLFdBQVcsQ0FBQztBQUM5QixXQUFPLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyxDQUFDO0FBQ25CLFVBQU0sQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxLQUFLLENBQUMsQ0FBQzs7QUFFeEMsV0FBTyxLQUFLLENBQUM7SUFDZDs7QUFFRCxjQUFZO1VBQUEsc0JBQUMsSUFBSSxFQUFDO0FBQ2pCLFFBQUksT0FBTyxHQUFHLFFBQVEsQ0FBQyxhQUFhLENBQUMsS0FBSyxDQUFDLENBQUM7QUFDNUMsV0FBTyxDQUFDLFdBQVcsQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUM7QUFDMUMsUUFBSSxHQUFHLEdBQUcsT0FBTyxDQUFDLFNBQVMsQ0FBQztBQUM1QixXQUFPLEdBQUcsSUFBSSxHQUFHLElBQUksQ0FBQztBQUN0QixXQUFPLEdBQUcsQ0FBQztJQUNYOzs7O1FBak1JLGVBQWU7OztBQXFNckIsSUFBTSxJQUFJLEdBQUcsQ0FBQSxZQUFNO0FBQ2xCLEtBQUksZ0JBQWdCLEdBQUcsUUFBUSxDQUFDLGdCQUFnQixDQUFDLG9CQUFvQixDQUFDLENBQUM7QUFDdkUsS0FBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDOzs7Ozs7QUFDVix1QkFBMkIsZ0JBQWdCO09BQW5DLGVBQWU7O0FBQ3RCLGtCQUFlLENBQUMsWUFBWSxDQUFDLElBQUksRUFBQyxnQkFBZ0IsR0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDO0FBQ3hELE9BQUksZUFBZSxDQUFDLGVBQWUsQ0FBQyxDQUFDO0dBQ3JDOzs7Ozs7Ozs7Ozs7Ozs7Q0FDRCxDQUFBLENBRUEsWUFBVTtBQUNWLFNBQVEsQ0FBQyxnQkFBZ0IsQ0FBQyxrQkFBa0IsRUFBRSxJQUFJLENBQUMsQ0FBQztDQUVwRCxDQUFDLENBQUMiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dmFyIGY9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitvK1wiJ1wiKTt0aHJvdyBmLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsZn12YXIgbD1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwobC5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxsLGwuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pIiwiXCJ1c2Ugc3RyaWN0XCI7XG5cbi8vY29uc3QgdGVzdF91cmwgPSBcImh0dHBzOi8vbWVkaXVtLmNvbS9wbGF5d2VsbC9uby1tYW5zLXNreS1hbmQtdGhlLWJlYXV0aWZ1bC1yZXR1cm4tdG8tdGhlLXdlaXJkLTgxMzQzZjJhYWQzNy9cIjtcblxuXG5jbGFzcyBTdXBlclNlYXJjaExpbmUge1xuXG5cdGNvbnN0cnVjdG9yKHN1cGVyU2VhcmNoTGluZU5vZGUpIHtcblx0XHRcblx0XHQvLyDQo9GB0YLQsNC90LDQstC70LjQstCw0LXQvCDQsdCw0LfQvtCy0YvQtSDQv9C10YDQtdC80LXQvdC90YvQtVxuXHRcdHRoaXMucmVtb3RlID0gXCJodHRwOi8vc3VwZXItYW5hbHl0aWNzLmNvbS9cIjtcblxuXHRcdHRoaXMuaWQgPSBzdXBlclNlYXJjaExpbmVOb2RlLmdldEF0dHJpYnV0ZShcImlkXCIpO1xuXHRcdHRoaXMuYmFzZUNsYXNzID0gJ3N1cGVyLXNlYXJjaC1saW5lJztcblx0XHR0aGlzLmJhc2VDbGFzc1NlbGVjdG9yID0gXCIuXCIrdGhpcy5iYXNlQ2xhc3M7XG5cdFx0dGhpcy51cmxQYXR0ZXJuID0gbmV3IFJlZ0V4cCgvKGh0dHBzPzpcXC9cXC8pPygoPzp3d3dcXC4pP1stYS16QS1aMC05QDolLl9cXCt+Iz1dezIsMjU2fVxcLlthLXpdezIsNn1cXGIpKFstYS16QS1aMC05QDolX1xcKy5+Iz8mLy89XSopLyk7XG5cdFx0XG5cdFx0Ly8g0J7Qv9GA0LXQtNC10LvRj9C10Lwg0Y3Qu9C10LzQtdC90YLRi1xuXHRcdHRoaXMuc3VwZXJTZWFyY2hMaW5lRm9ybSA9IHN1cGVyU2VhcmNoTGluZU5vZGUucXVlcnlTZWxlY3Rvcih0aGlzLmJhc2VDbGFzc1NlbGVjdG9yK1wiX19mb3JtXCIpO1xuXHRcdHRoaXMuc3VwZXJTZWFyY2hMaW5lSW5wdXQgPSBzdXBlclNlYXJjaExpbmVOb2RlLnF1ZXJ5U2VsZWN0b3IodGhpcy5iYXNlQ2xhc3NTZWxlY3RvcitcIl9faW5wdXRcIik7XG5cdFx0dGhpcy5zdXBlclNlYXJjaExpbmVSZXNldCA9IHN1cGVyU2VhcmNoTGluZU5vZGUucXVlcnlTZWxlY3Rvcih0aGlzLmJhc2VDbGFzc1NlbGVjdG9yK1wiX19yZXNldFwiKTtcblx0XHR0aGlzLnN1cGVyU2VhcmNoTGluZUJ1dHRvbiA9IHN1cGVyU2VhcmNoTGluZU5vZGUucXVlcnlTZWxlY3Rvcih0aGlzLmJhc2VDbGFzc1NlbGVjdG9yK1wiX19idXR0b25cIik7XG5cdFx0Ly8g0J3QsNCy0LXRiNC40LLQsNC10Lwg0YHQvtCx0YvRgtC40Y9cblx0XHR0aGlzLnN1cGVyU2VhcmNoTGluZUlucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsdGhpcy5zdXBlclNlYXJjaExpbmVJbnB1dEhhbmRsZXIuYmluZCh0aGlzKSk7XG5cdFx0dGhpcy5zdXBlclNlYXJjaExpbmVJbnB1dC5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsdGhpcy5zdXBlclNlYXJjaExpbmVJbnB1dEhhbmRsZXIuYmluZCh0aGlzKSk7XG5cdFx0dGhpcy5zdXBlclNlYXJjaExpbmVSZXNldC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsdGhpcy5zdXBlclNlYXJjaExpbmVSZXNldFZhbHVlLmJpbmQodGhpcykpO1xuXHRcdHRoaXMuc3VwZXJTZWFyY2hMaW5lQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJyx0aGlzLnN1cGVyU2VhcmNoTGluZVN1Ym1pdC5iaW5kKHRoaXMpKTtcblx0XHR0aGlzLnN1cGVyU2VhcmNoTGluZUZvcm0uYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0Jyx0aGlzLnN1cGVyU2VhcmNoTGluZVN1Ym1pdC5iaW5kKHRoaXMpKTtcblx0XHRcblxuXHRcdC8vINCh0L7Qt9C00LDQtdC8INGN0LvQtdC80LXQvdGC0Ysg0LTQu9GPINC+0YLQvtCx0YDQsNC20LXQvdC40Y8g0YDQtdC30YPQu9GM0YLQsNGC0LBcblxuXHRcdC8vINCh0L7Qt9C00LDQtdC8INCx0LvQvtC60Lgg0LTQu9GPINC/0L7QtNGB0LrQsNC30L7QulxuXHRcdHRoaXMubGlua1RleHRFbDEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcblx0XHR0aGlzLmxpbmtUZXh0RWwyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG5cdFx0dGhpcy5saW5rVGV4dEVsMyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuXG5cdFx0dGhpcy5saW5rVGV4dEVsMS5jbGFzc0xpc3QuYWRkKGAke3RoaXMuYmFzZUNsYXNzfV9fbGluay10ZXh0YCk7XG5cdFx0dGhpcy5saW5rVGV4dEVsMi5jbGFzc0xpc3QuYWRkKGAke3RoaXMuYmFzZUNsYXNzfV9fbGluay10ZXh0YCk7XG5cdFx0dGhpcy5saW5rVGV4dEVsMy5jbGFzc0xpc3QuYWRkKGAke3RoaXMuYmFzZUNsYXNzfV9fbGluay10ZXh0YCk7XG5cblx0XHQvLyDQodC+0LfQtNCw0LXQvCDQsdC70L7QutC4INC/0L7Rj9GB0L3Rj9GO0YnQtdCz0L4g0YLQtdC60YHRgtCwINC4INGB0YDQsNC30YMg0YHRh9C40YLQsNC10Lwg0YjQuNGA0LjQvdGDINGCLtC6LiDQsiDQtNCw0LvRjNC90LXQudGI0LXQvCDQvdC1INC80LXQvdGP0Y7RgtGB0Y8gXG5cdFx0dGhpcy5oZWxwZXJFbDEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcblx0XHR0aGlzLmhlbHBlckVsMiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuXHRcdHRoaXMuaGVscGVyRWwzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG5cdFx0XG5cdFx0dGhpcy5oZWxwZXJFbDEuY2xhc3NMaXN0LmFkZChgJHt0aGlzLmJhc2VDbGFzc31fX2hlbHBlcmApO1xuXHRcdHRoaXMuaGVscGVyRWwyLmNsYXNzTGlzdC5hZGQoYCR7dGhpcy5iYXNlQ2xhc3N9X19oZWxwZXJgKTtcblx0XHR0aGlzLmhlbHBlckVsMy5jbGFzc0xpc3QuYWRkKGAke3RoaXMuYmFzZUNsYXNzfV9faGVscGVyYCk7XG5cblx0XHR0aGlzLmhlbHBlckVsMS5pbm5lckhUTUwgPSBgaW4gPHNwYW4gY2xhc3M9XCIke3RoaXMuYmFzZUNsYXNzfV9faGVscGVyLXR5cGVcIj5QaHJhc2UgT3ZlcnZpZXc8L3NwYW4+YDtcblx0XHR0aGlzLmhlbHBlckVsMi5pbm5lckhUTUwgPSBgaW4gPHNwYW4gY2xhc3M9XCIke3RoaXMuYmFzZUNsYXNzfV9faGVscGVyLXR5cGVcIj5Eb21haW4gT3ZlcnZpZXc8L3NwYW4+YDtcblx0XHR0aGlzLmhlbHBlckVsMy5pbm5lckhUTUwgPSBgaW4gPHNwYW4gY2xhc3M9XCIke3RoaXMuYmFzZUNsYXNzfV9faGVscGVyLXR5cGVcIj5VUkwgT3ZlcnZpZXc8L3NwYW4+YDtcblx0XHRcblx0XHR0aGlzLmhlbHBlclN0cjFXaWR0aCA9IHRoaXMuc3RyaW5nV2lkdGhJblBYKHRoaXMuaGVscGVyRWwxKTtcblx0XHR0aGlzLmhlbHBlclN0cjJXaWR0aCA9IHRoaXMuc3RyaW5nV2lkdGhJblBYKHRoaXMuaGVscGVyRWwyKTtcblx0XHR0aGlzLmhlbHBlclN0cjNXaWR0aCA9IHRoaXMuc3RyaW5nV2lkdGhJblBYKHRoaXMuaGVscGVyRWwzKTtcblx0fVxuXG5cdFxuXHRwYXJzZVVybCh1cmwpe1xuXHRcdHJldHVybiB0aGlzLnVybFBhdHRlcm4udGVzdCh1cmwpO1xuXHR9XG5cblx0c3VwZXJTZWFyY2hMaW5lUmVzZXRWYWx1ZSgpe1xuXHRcdHRoaXMuc3VwZXJTZWFyY2hMaW5lSW5wdXQudmFsdWUgPSBudWxsO1xuXHRcdC8vdGhpcy5zdXBlclNlYXJjaExpbmVJbnB1dC5jaGFuZ2UoKTtcblx0XHR0aGlzLnN1cGVyU2VhcmNoTGluZVJlc2V0LmNsYXNzTGlzdC5hZGQoJ2hpZGRlbicpO1xuXHRcdHRoaXMuc3VwZXJTZWFyY2hMaW5lQnV0dG9uLnNldEF0dHJpYnV0ZShcImRpc2FibGVkXCIsXCJkaXNhYmxlZFwiKTtcblx0XHRsZXQgcmVzdWx0ID0gdGhpcy5zdXBlclNlYXJjaExpbmVGb3JtLnF1ZXJ5U2VsZWN0b3IodGhpcy5iYXNlQ2xhc3NTZWxlY3RvcitcIl9fcmVzdWx0XCIpO1xuXHRcdHJlc3VsdCAmJiB0aGlzLnN1cGVyU2VhcmNoTGluZUZvcm0ucmVtb3ZlQ2hpbGQocmVzdWx0KTtcblx0XHQvL2NvbnNvbGUubG9nKHRoaXMuc3VwZXJTZWFyY2hMaW5lSW5wdXQudmFsdWUpO1xuXHR9XG5cblx0c3VwZXJTZWFyY2hMaW5lU3VibWl0KGUpe1xuXHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0XHRsZXQgWEhSID0gKFwib25sb2FkXCIgaW4gbmV3IFhNTEh0dHBSZXF1ZXN0KCkpID8gWE1MSHR0cFJlcXVlc3QgOiBYRG9tYWluUmVxdWVzdDtcblx0XHRsZXQgciA9IG5ldyBYSFIoKTtcblx0XHRsZXQgZGF0YSA9IGBmb3JtSWQ9JHtlbmNvZGVVUklDb21wb25lbnQodGhpcy5pZCl9JnF1ZXJ5PSR7ZW5jb2RlVVJJQ29tcG9uZW50KHRoaXMuc3VwZXJTZWFyY2hMaW5lSW5wdXQudmFsdWUpfWA7XG5cdFx0ci5vcGVuKFwiUE9TVFwiLHRoaXMucmVtb3RlKTtcblx0XHRyLm9ubG9hZCA9IChyZXNwb25zZSkgPT4ge1xuXHRcdFx0Y29uc29sZS5sb2cocmVzcG9uc2UpO1xuXHRcdH07XG5cdFx0ci5vbmVycm9yID0gKGVycm9yKSA9PiB7XG5cdFx0XHRjb25zb2xlLmxvZyhcItCe0YjQuNCx0LrQsDogXCIsIGVycm9yKTtcblx0XHR9O1xuXHRcdHIuc2VuZChkYXRhKTtcblx0fVxuXG5cdHN1cGVyU2VhcmNoTGluZVJlc3VsdEdlbmVyYXRvcihwcm90b2NvbCwgZG9tYWluLCBxdWVyeSl7XG5cdFx0bGV0IGlucHV0V2lkdGggPSB0aGlzLnN1cGVyU2VhcmNoTGluZUlucHV0Lm9mZnNldFdpZHRoO1xuXG5cdFx0Ly8g0JfQsNC/0LjRgdGL0LLQsNC10Lwg0YLQtdC60YHRgiDQsiDQsdC70L7QutC4INGA0LXQt9GD0LvRjNGC0LDRgtCwINC4INGB0YfQuNGC0LDQtdC8INC40YUg0YjQuNGA0LjQvdGDXG5cdFx0dGhpcy5saW5rVGV4dEVsMS5pbm5lckhUTUwgPSBwcm90b2NvbCtkb21haW4rcXVlcnk7XG5cdFx0bGV0IGxpbmtTdHIxV2lkdGggPSB0aGlzLnN0cmluZ1dpZHRoSW5QWCh0aGlzLmxpbmtUZXh0RWwxKTtcblx0XHR0aGlzLmxpbmtUZXh0RWwyLmlubmVySFRNTCA9IGRvbWFpbjtcblx0XHRsZXQgbGlua1N0cjJXaWR0aCA9IHRoaXMuc3RyaW5nV2lkdGhJblBYKHRoaXMubGlua1RleHRFbDIpO1xuXHRcdHRoaXMubGlua1RleHRFbDMuaW5uZXJIVE1MID0gZG9tYWluK3F1ZXJ5O1xuXHRcdGxldCBsaW5rU3RyM1dpZHRoID0gdGhpcy5zdHJpbmdXaWR0aEluUFgodGhpcy5saW5rVGV4dEVsMyk7XG5cblx0XHRcblx0XHRcblx0XHRsZXQgc3VwZXJTZWFyY2hMaW5lUmVzdWx0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG5cdFx0c3VwZXJTZWFyY2hMaW5lUmVzdWx0LnNldEF0dHJpYnV0ZSgnY2xhc3MnLCB0aGlzLmJhc2VDbGFzcytcIl9fcmVzdWx0XCIpO1xuXHRcdGxldCBoZWxwZXJGaXhlZENsYXNzID0gYCR7dGhpcy5iYXNlQ2xhc3N9X19oZWxwZXItLWZpeGVkYDtcblxuXHRcdChpbnB1dFdpZHRoIC0gdGhpcy5oZWxwZXJTdHIxV2lkdGggPCBsaW5rU3RyMVdpZHRoKSA/IHRoaXMuaGVscGVyRWwxLmNsYXNzTGlzdC5hZGQoaGVscGVyRml4ZWRDbGFzcykgOiB0aGlzLmhlbHBlckVsMS5jbGFzc0xpc3QucmVtb3ZlKGhlbHBlckZpeGVkQ2xhc3MpO1xuXHRcdChpbnB1dFdpZHRoIC0gdGhpcy5oZWxwZXJTdHIyV2lkdGggPCBsaW5rU3RyMldpZHRoKSA/IHRoaXMuaGVscGVyRWwyLmNsYXNzTGlzdC5hZGQoaGVscGVyRml4ZWRDbGFzcykgOiB0aGlzLmhlbHBlckVsMi5jbGFzc0xpc3QucmVtb3ZlKGhlbHBlckZpeGVkQ2xhc3MpO1xuXHRcdChpbnB1dFdpZHRoIC0gdGhpcy5oZWxwZXJTdHIzV2lkdGggPCBsaW5rU3RyM1dpZHRoKSA/IHRoaXMuaGVscGVyRWwzLmNsYXNzTGlzdC5hZGQoaGVscGVyRml4ZWRDbGFzcykgOiB0aGlzLmhlbHBlckVsMy5jbGFzc0xpc3QucmVtb3ZlKGhlbHBlckZpeGVkQ2xhc3MpO1xuXG5cblx0XHRsZXQgc3VwZXJTZWFyY2hMaW5lSXRlbXMgPVx0XG5cdFx0XHRgPGRpdiBjbGFzcz1cIiR7dGhpcy5iYXNlQ2xhc3N9X19pdGVtXCI+XG5cdFx0XHRcdDxhIGhyZWY9XCIke3RoaXMucmVtb3RlfT9zdWdnZXN0aW9uVHlwZT1waHJhc2UmcXVlcnk9JHtwcm90b2NvbCtkb21haW4rcXVlcnl9XCIgdGFyZ2V0PVwiX2JsYW5rXCIgY2xhc3M9XCIke3RoaXMuYmFzZUNsYXNzfV9fbGlua1wiPlxuXHRcdFx0XHRcdCR7dGhpcy5ub2RlVG9TdHJpbmcodGhpcy5saW5rVGV4dEVsMSl9XG5cdFx0XHRcdFx0JHt0aGlzLm5vZGVUb1N0cmluZyh0aGlzLmhlbHBlckVsMSl9XG5cdFx0XHRcdDwvYT5cblx0XHRcdFx0XG5cdFx0XHQ8L2Rpdj5cblx0XHRcdDxkaXYgY2xhc3M9XCIke3RoaXMuYmFzZUNsYXNzfV9faXRlbVwiPlxuXHRcdFx0XHQ8YSBocmVmPVwiJHt0aGlzLnJlbW90ZX0/c3VnZ2VzdGlvblR5cGU9ZG9tYWluJnF1ZXJ5PSR7ZG9tYWlufVwiIHRhcmdldD1cIl9ibGFua1wiIGNsYXNzPVwiJHt0aGlzLmJhc2VDbGFzc31fX2xpbmtcIj5cblx0XHRcdFx0XHQke3RoaXMubm9kZVRvU3RyaW5nKHRoaXMubGlua1RleHRFbDIpfVxuXHRcdFx0XHRcdCR7dGhpcy5ub2RlVG9TdHJpbmcodGhpcy5oZWxwZXJFbDIpfVxuXHRcdFx0XHQ8L2E+XG5cdFx0XHQ8L2Rpdj5cblx0XHRcdDxkaXYgY2xhc3M9XCIke3RoaXMuYmFzZUNsYXNzfV9faXRlbVwiPlxuXHRcdFx0XHQ8YSBocmVmPVwiJHt0aGlzLnJlbW90ZX0/c3VnZ2VzdGlvblR5cGU9dXJsJnF1ZXJ5PSR7ZG9tYWluK3F1ZXJ5fVwiIHRhcmdldD1cIl9ibGFua1wiIGNsYXNzPVwiJHt0aGlzLmJhc2VDbGFzc31fX2xpbmtcIj5cblx0XHRcdFx0XHQke3RoaXMubm9kZVRvU3RyaW5nKHRoaXMubGlua1RleHRFbDMpfVxuXHRcdFx0XHRcdCR7dGhpcy5ub2RlVG9TdHJpbmcodGhpcy5oZWxwZXJFbDMpfVxuXHRcdFx0XHQ8L2E+XG5cdFx0XHQ8L2Rpdj5gO1xuXHRcdHN1cGVyU2VhcmNoTGluZVJlc3VsdC5pbm5lckhUTUwgPSBzdXBlclNlYXJjaExpbmVJdGVtcztcblx0XHRyZXR1cm4gc3VwZXJTZWFyY2hMaW5lUmVzdWx0O1xuXHR9XG5cblx0c3VwZXJTZWFyY2hMaW5lSW5wdXRIYW5kbGVyKGUpe1xuXHRcdGxldCB2YWx1ZSA9IGUudGFyZ2V0LnZhbHVlO1xuXHRcdGxldCByZXN1bHQgPSB0aGlzLnN1cGVyU2VhcmNoTGluZUZvcm0ucXVlcnlTZWxlY3Rvcih0aGlzLmJhc2VDbGFzc1NlbGVjdG9yK1wiX19yZXN1bHRcIik7XG5cdFx0cmVzdWx0ICYmIHRoaXMuc3VwZXJTZWFyY2hMaW5lRm9ybS5yZW1vdmVDaGlsZChyZXN1bHQpO1xuXHRcdGlmKHZhbHVlICE9PSBudWxsICYmIHZhbHVlICE9PSBcIlwiKXtcblx0XHRcdHRoaXMuc3VwZXJTZWFyY2hMaW5lUmVzZXQuY2xhc3NMaXN0LnJlbW92ZSgnaGlkZGVuJyk7XG5cdFx0XHR0aGlzLnN1cGVyU2VhcmNoTGluZUJ1dHRvbi5yZW1vdmVBdHRyaWJ1dGUoXCJkaXNhYmxlZFwiKTtcblx0XHRcdGlmKHRoaXMucGFyc2VVcmwodmFsdWUpKXtcblx0XHRcdFx0bGV0IHJlc3VsdCA9IHZhbHVlLm1hdGNoKHRoaXMudXJsUGF0dGVybik7XG5cdFx0XHRcdGxldCBwcm90b2NvbCA9IHJlc3VsdFsxXTtcblx0XHRcdFx0bGV0IGRvbWFpbiA9IHJlc3VsdFsyXTtcblx0XHRcdFx0bGV0IHF1ZXJ5ID0gcmVzdWx0WzNdO1xuXHRcdFx0XHRsZXQgc3VwZXJTZWFyY2hMaW5lUmVzdWx0ID0gdGhpcy5zdXBlclNlYXJjaExpbmVSZXN1bHRHZW5lcmF0b3IocHJvdG9jb2wsZG9tYWluLHF1ZXJ5KTtcblx0XHRcdFx0Y29uc29sZS5sb2codHJ1ZSk7XG5cdFx0XHRcdHRoaXMuc3VwZXJTZWFyY2hMaW5lRm9ybS5hcHBlbmRDaGlsZChzdXBlclNlYXJjaExpbmVSZXN1bHQpO1xuXHRcdFx0fVx0XHRcblx0XHR9ZWxzZXtcblx0XHRcdHRoaXMuc3VwZXJTZWFyY2hMaW5lUmVzZXQuY2xhc3NMaXN0LmFkZCgnaGlkZGVuJyk7XG5cdFx0XHR0aGlzLnN1cGVyU2VhcmNoTGluZUJ1dHRvbi5zZXRBdHRyaWJ1dGUoXCJkaXNhYmxlZFwiLFwiZGlzYWJsZWRcIik7XG5cdFx0fVx0XG5cdH1cblxuXHRzdHJpbmdXaWR0aEluUFgoZWwpIHtcblx0ICAvLyDQtNC+0L/QvtC70L3QuNGC0LXQu9GM0L3Ri9C1INGB0YLQuNC70Lgg0LTQu9GPINC60LvQvtC90LAsINGH0YLQviDQsdGLINC80LjRgCDQvdC1INC30LDQvNC10YLQuNC7INGH0YPQtNCwLCDQuCDRgNCw0LfQvNC10YDRiyDQvtGC0L7QsdGA0LDQttCw0LvQuNGB0Ywg0LrQvtGA0YDQtdC60YLQvdC+XG5cdCAgbGV0IGhpZGRlblN0eWxlID0gXCJsZWZ0Oi0xMDAwMHB4O3RvcDotMTAwMDBweDtoZWlnaHQ6YXV0bzt3aWR0aDphdXRvO3Bvc2l0aW9uOmFic29sdXRlO1wiO1xuXG5cdCAgLy8g0YHQvtC30LTQsNC10LwgYm94INGN0LvQtdC80LXQvdGCIFxuXHQgIC8vINC00LvRjyDQutC70L7QvdC40YDQvtCy0LDQvdC40Y8g0YHQvtC00LXRgNC20LjQvNC+0LPQviDQuNC3INC90LDRiNC10LPQviDQuNGB0YXQvtC00L3QvtCz0L4gaW5saW5lINCx0LvQvtC60LBcblx0ICBsZXQgY2xvbmUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcblx0ICBcblx0ICAvLyDQsiDQvtCx0Y/Qt9Cw0YLQtdC70YzQvdC+0Lwg0L/QvtGA0Y/QtNC60LUg0LrQvtC/0LjRgNGD0LXQvCDRgdGC0LjQu9C4INGBINC40YHRhdC+0LTQvdC+0LPQviDRjdC70LXQvNC10L3RgtCwLCBcblx0ICAvLyDRh9GC0L4g0LHRiyDRgNCw0LfQvNC10YDRiyDRgdC+0L7RgtCy0LXRgtGB0YLQstC+0LLQsNC70Lgg0LjRgdGF0L7QtNC90LjQutGDLlxuXHQgIGxldCBzdHlsZSA9IHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKGVsLCBudWxsKTtcblx0ICBjbG9uZS5jbGFzc0xpc3QgPSBlbC5jbGFzc0xpc3Q7XHQgIFxuXHQgIGZvciAobGV0IGkgaW4gZWwuc3R5bGUpIHtcblx0ICAgIHRyeSB7XG5cdCAgICAgIGlmICgoZWwuc3R5bGVbaV0gIT0gJycpICYmIChlbC5zdHlsZVtpXS5pbmRleE9mKFwiOlwiKSA+IDApKSB7XG5cdCAgICAgICAgY2xvbmUuc3R5bGVbaV0gPSBlbC5zdHlsZVtpXTtcblx0ICAgICAgfVxuXHQgICAgfSBjYXRjaCAoZSkge31cblx0ICB9XG5cdCAgXG5cdCAgLy8g0YPRgdGC0LDQvdCw0LLQu9C40LLQsNC10Lwg0YHRgtC40LvQuCDRgyDQutC70L7QvdCwLCDQtNCw0LHRiyDQvtC9INC90LUg0LzQvtC30L7Qu9C40Lsg0LPQu9Cw0LcuIFxuXHQgIC8vINCj0YfQuNGC0YvQstCw0LXQvCwg0YfRgtC+IElFINC90LUg0L/QvtC30LLQvtC70Y/QtdGCINC90LDQv9GA0Y/QvNGD0Y4g0YPRgdGC0LDQvdCw0LLQu9C40LLQsNGC0Ywg0LfQvdCw0YfQtdC90LjQtSDQsNGC0YLRgNC40LHRg9GC0LAgc3R5bGVcblx0ICBkb2N1bWVudC5hbGwgPyBjbG9uZS5zdHlsZS5zZXRBdHRyaWJ1dGUoJ2Nzc1RleHQnLCBoaWRkZW5TdHlsZSkgOiBjbG9uZS5zZXRBdHRyaWJ1dGUoJ3N0eWxlJywgaGlkZGVuU3R5bGUpO1xuXG5cdCAgY2xvbmUuaW5uZXJIVE1MID0gZWwuaW5uZXJIVE1MXG5cdCAgXG5cdCAgcGFyZW50LmRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoY2xvbmUpO1xuXHQgIFxuXHQgIGxldCB3aWR0aCA9IGNsb25lLmNsaWVudFdpZHRoO1xuXHQgIGNvbnNvbGUubG9nKHdpZHRoKTtcblx0ICBwYXJlbnQuZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZChjbG9uZSk7XG5cblx0ICByZXR1cm4gd2lkdGg7XG5cdH1cblxuXHRub2RlVG9TdHJpbmcobm9kZSl7XG5cdFx0bGV0IHRtcE5vZGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuXHRcdHRtcE5vZGUuYXBwZW5kQ2hpbGQobm9kZS5jbG9uZU5vZGUodHJ1ZSkpO1xuXHRcdGxldCBzdHIgPSB0bXBOb2RlLmlubmVySFRNTDtcblx0XHR0bXBOb2RlID0gbm9kZSA9IG51bGw7XG5cdFx0cmV0dXJuIHN0cjtcblx0fVxufVxuXG5cbmNvbnN0IGluaXQgPSAoKSA9PiB7XG5cdGxldCBzdXBlclNlYXJjaExpbmVzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnN1cGVyLXNlYXJjaC1saW5lJyk7XG5cdGxldCBpID0gMDtcblx0Zm9yKGxldCBzdXBlclNlYXJjaExpbmUgb2Ygc3VwZXJTZWFyY2hMaW5lcykge1xuXHRcdHN1cGVyU2VhcmNoTGluZS5zZXRBdHRyaWJ1dGUoJ2lkJyxcInN1cGVyU2VhY2hMaW5lXCIraSsrKTtcblx0XHRuZXcgU3VwZXJTZWFyY2hMaW5lKHN1cGVyU2VhcmNoTGluZSk7XG5cdH1cbn1cblxuKGZ1bmN0aW9uKCl7XG5cdGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBpbml0KTtcblx0XG59KTtcbiJdfQ==
