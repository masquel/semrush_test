(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.app = f()}})(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({"./src/js/app.js":[function(_dereq_,module,exports){
"use strict";

var _createClass = (function () { function defineProperties(target, props) { for (var key in props) { var prop = props[key]; prop.configurable = true; if (prop.value) prop.writable = true; } Object.defineProperties(target, props); } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();

var _classCallCheck = function (instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } };

//const test_url = "https://medium.com/playwell/no-mans-sky-and-the-beautiful-return-to-the-weird-81343f2aad37/";

var SuperSearchLine = (function () {
	function SuperSearchLine(superSearchLineNode) {
		_classCallCheck(this, SuperSearchLine);

		// Устанавливаем базовые переменные
		this.remote = "http://super-analytics.com/";

		this.id = superSearchLineNode.getAttribute("id");
		this.baseClass = "super-search-line";
		this.baseClassSelector = "." + this.baseClass;
		this.urlPattern = new RegExp(/(https?:\/\/)?((?:www\.)?[-a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,6}\b)([-a-zA-Z0-9@:%_\+.~#?&//=]*)/);

		// Определяем элементы
		this.superSearchLineForm = superSearchLineNode.querySelector(this.baseClassSelector + "__form");
		this.superSearchLineInput = superSearchLineNode.querySelector(this.baseClassSelector + "__input");
		this.superSearchLineReset = superSearchLineNode.querySelector(this.baseClassSelector + "__reset");
		this.superSearchLineButton = superSearchLineNode.querySelector(this.baseClassSelector + "__button");
		// Навешиваем события
		this.superSearchLineInput.addEventListener("change", this.superSearchLineInputHandler.bind(this));
		this.superSearchLineInput.addEventListener("input", this.superSearchLineInputHandler.bind(this));
		this.superSearchLineReset.addEventListener("click", this.superSearchLineResetValue.bind(this));
		this.superSearchLineButton.addEventListener("click", this.superSearchLineSubmit.bind(this));
		this.superSearchLineForm.addEventListener("submit", this.superSearchLineSubmit.bind(this));

		// Создаем элементы для отображения результата

		// Создаем блоки для подсказок
		this.linkTextEl1 = document.createElement("div");
		this.linkTextEl2 = document.createElement("div");
		this.linkTextEl3 = document.createElement("div");
		this.linkTextEl1.classList.add("" + this.baseClass + "__link-text");
		this.linkTextEl2.classList.add("" + this.baseClass + "__link-text");
		this.linkTextEl3.classList.add("" + this.baseClass + "__link-text");

		// Создаем блоки поясняющего текста и сразу считаем ширину т.к. в дальнейшем не меняются
		this.helperEl1 = document.createElement("div");
		this.helperEl2 = document.createElement("div");
		this.helperEl3 = document.createElement("div");

		this.helperEl1.classList.add("" + this.baseClass + "__helper");
		this.helperEl2.classList.add("" + this.baseClass + "__helper");
		this.helperEl3.classList.add("" + this.baseClass + "__helper");

		this.helperEl1.innerHTML = "in <span class=\"" + this.baseClass + "__helper-type\">Phrase Overview</span>";
		this.helperEl2.innerHTML = "in <span class=\"" + this.baseClass + "__helper-type\">Domain Overview</span>";
		this.helperEl3.innerHTML = "in <span class=\"" + this.baseClass + "__helper-type\">URL Overview</span>";

		this.helperStr1Width = this.stringWidthInPX(this.helperEl1);
		this.helperStr2Width = this.stringWidthInPX(this.helperEl2);
		this.helperStr3Width = this.stringWidthInPX(this.helperEl3);
	}

	_createClass(SuperSearchLine, {
		parseUrl: {
			value: function parseUrl(url) {
				return this.urlPattern.test(url);
			}
		},
		superSearchLineResetValue: {
			value: function superSearchLineResetValue() {
				this.superSearchLineInput.value = null;
				//this.superSearchLineInput.change();
				this.superSearchLineReset.classList.add("hidden");
				this.superSearchLineButton.setAttribute("disabled", "disabled");
				var result = this.superSearchLineForm.querySelector(this.baseClassSelector + "__result");
				result && this.superSearchLineForm.removeChild(result);
				//console.log(this.superSearchLineInput.value);
			}
		},
		superSearchLineSubmit: {
			value: function superSearchLineSubmit(e) {
				e.preventDefault();
				var XHR = "onload" in new XMLHttpRequest() ? XMLHttpRequest : XDomainRequest;
				var r = new XHR();
				var data = {
					formId: this.id,
					query: this.superSearchLineInput.value
				};
				r.open("POST", this.remote);
				r.onload = function (response) {
					console.log(response);
				};
				r.onerror = function (error) {
					console.log("Ошибка: ", error);
				};
				r.send(data);
			}
		},
		superSearchLineResultGenerator: {
			value: function superSearchLineResultGenerator(protocol, domain, query) {
				var inputWidth = this.superSearchLineInput.offsetWidth;

				// Записываем текст в блоки результата и считаем их ширину
				this.linkTextEl1.innerHTML = protocol + domain + query;
				var linkStr1Width = this.stringWidthInPX(this.linkTextEl1);
				this.linkTextEl2.innerHTML = domain;
				var linkStr2Width = this.stringWidthInPX(this.linkTextEl2);
				this.linkTextEl3.innerHTML = domain + query;
				var linkStr3Width = this.stringWidthInPX(this.linkTextEl3);

				var superSearchLineResult = document.createElement("div");
				superSearchLineResult.setAttribute("class", this.baseClass + "__result");
				var helperFixedClass = "" + this.baseClass + "__helper--fixed";

				inputWidth - this.helperStr1Width < linkStr1Width ? this.helperEl1.classList.add(helperFixedClass) : this.helperEl1.classList.remove(helperFixedClass);
				inputWidth - this.helperStr2Width < linkStr2Width ? this.helperEl2.classList.add(helperFixedClass) : this.helperEl2.classList.remove(helperFixedClass);
				inputWidth - this.helperStr3Width < linkStr3Width ? this.helperEl3.classList.add(helperFixedClass) : this.helperEl3.classList.remove(helperFixedClass);

				var superSearchLineItems = "<div class=\"" + this.baseClass + "__item\">\n\t\t\t\t<a href=\"" + this.remote + "?suggestionType=phrase&query=" + (protocol + domain + query) + "\" target=\"_blank\" class=\"" + this.baseClass + "__link\">\n\t\t\t\t\t" + this.nodeToString(this.linkTextEl1) + "\n\t\t\t\t\t" + this.nodeToString(this.helperEl1) + "\n\t\t\t\t</a>\n\t\t\t\t\n\t\t\t</div>\n\t\t\t<div class=\"" + this.baseClass + "__item\">\n\t\t\t\t<a href=\"" + this.remote + "?suggestionType=domain&query=" + domain + "\" target=\"_blank\" class=\"" + this.baseClass + "__link\">\n\t\t\t\t\t" + this.nodeToString(this.linkTextEl2) + "\n\t\t\t\t\t" + this.nodeToString(this.helperEl2) + "\n\t\t\t\t</a>\n\t\t\t</div>\n\t\t\t<div class=\"" + this.baseClass + "__item\">\n\t\t\t\t<a href=\"" + this.remote + "?suggestionType=url&query=" + (domain + query) + "\" target=\"_blank\" class=\"" + this.baseClass + "__link\">\n\t\t\t\t\t" + this.nodeToString(this.linkTextEl3) + "\n\t\t\t\t\t" + this.nodeToString(this.helperEl3) + "\n\t\t\t\t</a>\n\t\t\t</div>";
				superSearchLineResult.innerHTML = superSearchLineItems;
				return superSearchLineResult;
			}
		},
		superSearchLineInputHandler: {
			value: function superSearchLineInputHandler(e) {
				var value = e.target.value;
				var result = this.superSearchLineForm.querySelector(this.baseClassSelector + "__result");
				result && this.superSearchLineForm.removeChild(result);
				if (value !== null && value !== "") {
					this.superSearchLineReset.classList.remove("hidden");
					this.superSearchLineButton.removeAttribute("disabled");
					if (this.parseUrl(value)) {
						var _result = value.match(this.urlPattern);
						var protocol = _result[1];
						var domain = _result[2];
						var query = _result[3];
						var superSearchLineResult = this.superSearchLineResultGenerator(protocol, domain, query);
						console.log(true);
						this.superSearchLineForm.appendChild(superSearchLineResult);
					}
				} else {
					this.superSearchLineReset.classList.add("hidden");
					this.superSearchLineButton.setAttribute("disabled", "disabled");
				}
			}
		},
		stringWidthInPX: {
			value: function stringWidthInPX(el) {
				// дополнительные стили для клона, что бы мир не заметил чуда, и размеры отображались корректно
				var hiddenStyle = "left:-10000px;top:-10000px;height:auto;width:auto;position:absolute;";

				// создаем box элемент
				// для клонирования содержимого из нашего исходного inline блока
				var clone = document.createElement("div");

				// в обязательном порядке копируем стили с исходного элемента,
				// что бы размеры соответствовали исходнику.
				for (var i in el.style) {
					try {
						if (el.style[i] != "" && el.style[i].indexOf(":") > 0) {
							clone.style[i] = el.style[i];
						}
					} catch (e) {}
				}

				// устанавливаем стили у клона, дабы он не мозолил глаз.
				// Учитываем, что IE не позволяет напрямую устанавливать значение аттрибута style
				document.all ? clone.style.setAttribute("cssText", hiddenStyle) : clone.setAttribute("style", hiddenStyle);

				// Переносим содержимое. Аккуратно.
				clone.innerHTML = el.innerHTML;

				// Добавляем клон в корневой документ.
				// Так, на всякий пожарный в parent, а то вдруг элемент внутри iframe?
				parent.document.body.appendChild(clone);

				// Забиваем заветное.
				var width = clone.clientWidth;
				console.log(width);

				// ...и тут же удаляем
				parent.document.body.removeChild(clone);

				// Вот собственно говоря и все.
				return width;
			}
		},
		nodeToString: {
			value: function nodeToString(node) {
				var tmpNode = document.createElement("div");
				tmpNode.appendChild(node.cloneNode(true));
				var str = tmpNode.innerHTML;
				tmpNode = node = null;
				return str;
			}
		}
	});

	return SuperSearchLine;
})();

var init = (function () {
	var superSearchLines = document.querySelectorAll(".super-search-line");
	var i = 0;
	var _iteratorNormalCompletion = true;
	var _didIteratorError = false;
	var _iteratorError = undefined;

	try {
		for (var _iterator = superSearchLines[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {
			var superSearchLine = _step.value;

			superSearchLine.setAttribute("id", "superSeachLine" + i++);
			new SuperSearchLine(superSearchLine);
		}
	} catch (err) {
		_didIteratorError = true;
		_iteratorError = err;
	} finally {
		try {
			if (!_iteratorNormalCompletion && _iterator["return"]) {
				_iterator["return"]();
			}
		} finally {
			if (_didIteratorError) {
				throw _iteratorError;
			}
		}
	}
})(function () {
	document.addEventListener("DOMContentLoaded", init);
});

},{}]},{},["./src/js/app.js"])("./src/js/app.js")
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJjOi9Vc2Vycy9hbGV4ZXkvRG9jdW1lbnRzL0dpdEh1Yi9zZW1ydXNoX3Rlc3Qvc3JjL2pzL2FwcC5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQ0FBLFlBQVksQ0FBQzs7Ozs7Ozs7SUFLUCxlQUFlO0FBRVQsVUFGTixlQUFlLENBRVIsbUJBQW1CLEVBQUU7d0JBRjVCLGVBQWU7OztBQUtuQixNQUFJLENBQUMsTUFBTSxHQUFHLDZCQUE2QixDQUFDOztBQUU1QyxNQUFJLENBQUMsRUFBRSxHQUFHLG1CQUFtQixDQUFDLFlBQVksQ0FBQyxJQUFJLENBQUMsQ0FBQztBQUNqRCxNQUFJLENBQUMsU0FBUyxHQUFHLG1CQUFtQixDQUFDO0FBQ3JDLE1BQUksQ0FBQyxpQkFBaUIsR0FBRyxHQUFHLEdBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQztBQUM1QyxNQUFJLENBQUMsVUFBVSxHQUFHLElBQUksTUFBTSxDQUFDLG9HQUFvRyxDQUFDLENBQUM7OztBQUduSSxNQUFJLENBQUMsbUJBQW1CLEdBQUcsbUJBQW1CLENBQUMsYUFBYSxDQUFDLElBQUksQ0FBQyxpQkFBaUIsR0FBQyxRQUFRLENBQUMsQ0FBQztBQUM5RixNQUFJLENBQUMsb0JBQW9CLEdBQUcsbUJBQW1CLENBQUMsYUFBYSxDQUFDLElBQUksQ0FBQyxpQkFBaUIsR0FBQyxTQUFTLENBQUMsQ0FBQztBQUNoRyxNQUFJLENBQUMsb0JBQW9CLEdBQUcsbUJBQW1CLENBQUMsYUFBYSxDQUFDLElBQUksQ0FBQyxpQkFBaUIsR0FBQyxTQUFTLENBQUMsQ0FBQztBQUNoRyxNQUFJLENBQUMscUJBQXFCLEdBQUcsbUJBQW1CLENBQUMsYUFBYSxDQUFDLElBQUksQ0FBQyxpQkFBaUIsR0FBQyxVQUFVLENBQUMsQ0FBQzs7QUFFbEcsTUFBSSxDQUFDLG9CQUFvQixDQUFDLGdCQUFnQixDQUFDLFFBQVEsRUFBQyxJQUFJLENBQUMs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V0FBVyxDQUFDLEtBQUssQ0FBQyxDQUFDOzs7QUFHeEMsV0FBTyxLQUFLLENBQUM7SUFDZDs7QUFFRCxjQUFZO1VBQUEsc0JBQUMsSUFBSSxFQUFDO0FBQ2pCLFFBQUksT0FBTyxHQUFHLFFBQVEsQ0FBQyxhQUFhLENBQUMsS0FBSyxDQUFDLENBQUM7QUFDNUMsV0FBTyxDQUFDLFdBQVcsQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUM7QUFDMUMsUUFBSSxHQUFHLEdBQUcsT0FBTyxDQUFDLFNBQVMsQ0FBQztBQUM1QixXQUFPLEdBQUcsSUFBSSxHQUFHLElBQUksQ0FBQztBQUN0QixXQUFPLEdBQUcsQ0FBQztJQUNYOzs7O1FBeE1JLGVBQWU7OztBQTRNckIsSUFBTSxJQUFJLEdBQUcsQ0FBQSxZQUFNO0FBQ2xCLEtBQUksZ0JBQWdCLEdBQUcsUUFBUSxDQUFDLGdCQUFnQixDQUFDLG9CQUFvQixDQUFDLENBQUM7QUFDdkUsS0FBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDOzs7Ozs7QUFDVix1QkFBMkIsZ0JBQWdCO09BQW5DLGVBQWU7O0FBQ3RCLGtCQUFlLENBQUMsWUFBWSxDQUFDLElBQUksRUFBQyxnQkFBZ0IsR0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDO0FBQ3hELE9BQUksZUFBZSxDQUFDLGVBQWUsQ0FBQyxDQUFDO0dBQ3JDOzs7Ozs7Ozs7Ozs7Ozs7Q0FDRCxDQUFBLENBRUEsWUFBVTtBQUNWLFNBQVEsQ0FBQyxnQkFBZ0IsQ0FBQyxrQkFBa0IsRUFBRSxJQUFJLENBQUMsQ0FBQztDQUVwRCxDQUFDLENBQUMiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dmFyIGY9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitvK1wiJ1wiKTt0aHJvdyBmLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsZn12YXIgbD1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwobC5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxsLGwuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pIiwiXCJ1c2Ugc3RyaWN0XCI7XG5cbi8vY29uc3QgdGVzdF91cmwgPSBcImh0dHBzOi8vbWVkaXVtLmNvbS9wbGF5d2VsbC9uby1tYW5zLXNreS1hbmQtdGhlLWJlYXV0aWZ1bC1yZXR1cm4tdG8tdGhlLXdlaXJkLTgxMzQzZjJhYWQzNy9cIjtcblxuXG5jbGFzcyBTdXBlclNlYXJjaExpbmUge1xuXG5cdGNvbnN0cnVjdG9yKHN1cGVyU2VhcmNoTGluZU5vZGUpIHtcblx0XHRcblx0XHQvLyDQo9GB0YLQsNC90LDQstC70LjQstCw0LXQvCDQsdCw0LfQvtCy0YvQtSDQv9C10YDQtdC80LXQvdC90YvQtVxuXHRcdHRoaXMucmVtb3RlID0gXCJodHRwOi8vc3VwZXItYW5hbHl0aWNzLmNvbS9cIjtcblxuXHRcdHRoaXMuaWQgPSBzdXBlclNlYXJjaExpbmVOb2RlLmdldEF0dHJpYnV0ZShcImlkXCIpO1xuXHRcdHRoaXMuYmFzZUNsYXNzID0gJ3N1cGVyLXNlYXJjaC1saW5lJztcblx0XHR0aGlzLmJhc2VDbGFzc1NlbGVjdG9yID0gXCIuXCIrdGhpcy5iYXNlQ2xhc3M7XG5cdFx0dGhpcy51cmxQYXR0ZXJuID0gbmV3IFJlZ0V4cCgvKGh0dHBzPzpcXC9cXC8pPygoPzp3d3dcXC4pP1stYS16QS1aMC05QDolLl9cXCt+Iz1dezIsMjU2fVxcLlthLXpdezIsNn1cXGIpKFstYS16QS1aMC05QDolX1xcKy5+Iz8mLy89XSopLyk7XG5cdFx0XG5cdFx0Ly8g0J7Qv9GA0LXQtNC10LvRj9C10Lwg0Y3Qu9C10LzQtdC90YLRi1xuXHRcdHRoaXMuc3VwZXJTZWFyY2hMaW5lRm9ybSA9IHN1cGVyU2VhcmNoTGluZU5vZGUucXVlcnlTZWxlY3Rvcih0aGlzLmJhc2VDbGFzc1NlbGVjdG9yK1wiX19mb3JtXCIpO1xuXHRcdHRoaXMuc3VwZXJTZWFyY2hMaW5lSW5wdXQgPSBzdXBlclNlYXJjaExpbmVOb2RlLnF1ZXJ5U2VsZWN0b3IodGhpcy5iYXNlQ2xhc3NTZWxlY3RvcitcIl9faW5wdXRcIik7XG5cdFx0dGhpcy5zdXBlclNlYXJjaExpbmVSZXNldCA9IHN1cGVyU2VhcmNoTGluZU5vZGUucXVlcnlTZWxlY3Rvcih0aGlzLmJhc2VDbGFzc1NlbGVjdG9yK1wiX19yZXNldFwiKTtcblx0XHR0aGlzLnN1cGVyU2VhcmNoTGluZUJ1dHRvbiA9IHN1cGVyU2VhcmNoTGluZU5vZGUucXVlcnlTZWxlY3Rvcih0aGlzLmJhc2VDbGFzc1NlbGVjdG9yK1wiX19idXR0b25cIik7XG5cdFx0Ly8g0J3QsNCy0LXRiNC40LLQsNC10Lwg0YHQvtCx0YvRgtC40Y9cblx0XHR0aGlzLnN1cGVyU2VhcmNoTGluZUlucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsdGhpcy5zdXBlclNlYXJjaExpbmVJbnB1dEhhbmRsZXIuYmluZCh0aGlzKSk7XG5cdFx0dGhpcy5zdXBlclNlYXJjaExpbmVJbnB1dC5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsdGhpcy5zdXBlclNlYXJjaExpbmVJbnB1dEhhbmRsZXIuYmluZCh0aGlzKSk7XG5cdFx0dGhpcy5zdXBlclNlYXJjaExpbmVSZXNldC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsdGhpcy5zdXBlclNlYXJjaExpbmVSZXNldFZhbHVlLmJpbmQodGhpcykpO1xuXHRcdHRoaXMuc3VwZXJTZWFyY2hMaW5lQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJyx0aGlzLnN1cGVyU2VhcmNoTGluZVN1Ym1pdC5iaW5kKHRoaXMpKTtcblx0XHR0aGlzLnN1cGVyU2VhcmNoTGluZUZvcm0uYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0Jyx0aGlzLnN1cGVyU2VhcmNoTGluZVN1Ym1pdC5iaW5kKHRoaXMpKTtcblx0XHRcblxuXHRcdC8vINCh0L7Qt9C00LDQtdC8INGN0LvQtdC80LXQvdGC0Ysg0LTQu9GPINC+0YLQvtCx0YDQsNC20LXQvdC40Y8g0YDQtdC30YPQu9GM0YLQsNGC0LBcblxuXHRcdC8vINCh0L7Qt9C00LDQtdC8INCx0LvQvtC60Lgg0LTQu9GPINC/0L7QtNGB0LrQsNC30L7QulxuXHRcdHRoaXMubGlua1RleHRFbDEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcblx0XHR0aGlzLmxpbmtUZXh0RWwyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG5cdFx0dGhpcy5saW5rVGV4dEVsMyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuXHRcdHRoaXMubGlua1RleHRFbDEuY2xhc3NMaXN0LmFkZChgJHt0aGlzLmJhc2VDbGFzc31fX2xpbmstdGV4dGApO1xuXHRcdHRoaXMubGlua1RleHRFbDIuY2xhc3NMaXN0LmFkZChgJHt0aGlzLmJhc2VDbGFzc31fX2xpbmstdGV4dGApO1xuXHRcdHRoaXMubGlua1RleHRFbDMuY2xhc3NMaXN0LmFkZChgJHt0aGlzLmJhc2VDbGFzc31fX2xpbmstdGV4dGApO1xuXG5cdFx0Ly8g0KHQvtC30LTQsNC10Lwg0LHQu9C+0LrQuCDQv9C+0Y/RgdC90Y/RjtGJ0LXQs9C+INGC0LXQutGB0YLQsCDQuCDRgdGA0LDQt9GDINGB0YfQuNGC0LDQtdC8INGI0LjRgNC40L3RgyDRgi7Qui4g0LIg0LTQsNC70YzQvdC10LnRiNC10Lwg0L3QtSDQvNC10L3Rj9GO0YLRgdGPIFxuXHRcdHRoaXMuaGVscGVyRWwxID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG5cdFx0dGhpcy5oZWxwZXJFbDIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcblx0XHR0aGlzLmhlbHBlckVsMyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuXHRcdFxuXHRcdHRoaXMuaGVscGVyRWwxLmNsYXNzTGlzdC5hZGQoYCR7dGhpcy5iYXNlQ2xhc3N9X19oZWxwZXJgKTtcblx0XHR0aGlzLmhlbHBlckVsMi5jbGFzc0xpc3QuYWRkKGAke3RoaXMuYmFzZUNsYXNzfV9faGVscGVyYCk7XG5cdFx0dGhpcy5oZWxwZXJFbDMuY2xhc3NMaXN0LmFkZChgJHt0aGlzLmJhc2VDbGFzc31fX2hlbHBlcmApO1xuXG5cdFx0dGhpcy5oZWxwZXJFbDEuaW5uZXJIVE1MID0gYGluIDxzcGFuIGNsYXNzPVwiJHt0aGlzLmJhc2VDbGFzc31fX2hlbHBlci10eXBlXCI+UGhyYXNlIE92ZXJ2aWV3PC9zcGFuPmA7XG5cdFx0dGhpcy5oZWxwZXJFbDIuaW5uZXJIVE1MID0gYGluIDxzcGFuIGNsYXNzPVwiJHt0aGlzLmJhc2VDbGFzc31fX2hlbHBlci10eXBlXCI+RG9tYWluIE92ZXJ2aWV3PC9zcGFuPmA7XG5cdFx0dGhpcy5oZWxwZXJFbDMuaW5uZXJIVE1MID0gYGluIDxzcGFuIGNsYXNzPVwiJHt0aGlzLmJhc2VDbGFzc31fX2hlbHBlci10eXBlXCI+VVJMIE92ZXJ2aWV3PC9zcGFuPmA7XG5cdFx0XG5cdFx0dGhpcy5oZWxwZXJTdHIxV2lkdGggPSB0aGlzLnN0cmluZ1dpZHRoSW5QWCh0aGlzLmhlbHBlckVsMSk7XG5cdFx0dGhpcy5oZWxwZXJTdHIyV2lkdGggPSB0aGlzLnN0cmluZ1dpZHRoSW5QWCh0aGlzLmhlbHBlckVsMik7XG5cdFx0dGhpcy5oZWxwZXJTdHIzV2lkdGggPSB0aGlzLnN0cmluZ1dpZHRoSW5QWCh0aGlzLmhlbHBlckVsMyk7XG5cdH1cblxuXHRcblx0cGFyc2VVcmwodXJsKXtcblx0XHRyZXR1cm4gdGhpcy51cmxQYXR0ZXJuLnRlc3QodXJsKTtcblx0fVxuXG5cdHN1cGVyU2VhcmNoTGluZVJlc2V0VmFsdWUoKXtcblx0XHR0aGlzLnN1cGVyU2VhcmNoTGluZUlucHV0LnZhbHVlID0gbnVsbDtcblx0XHQvL3RoaXMuc3VwZXJTZWFyY2hMaW5lSW5wdXQuY2hhbmdlKCk7XG5cdFx0dGhpcy5zdXBlclNlYXJjaExpbmVSZXNldC5jbGFzc0xpc3QuYWRkKCdoaWRkZW4nKTtcblx0XHR0aGlzLnN1cGVyU2VhcmNoTGluZUJ1dHRvbi5zZXRBdHRyaWJ1dGUoXCJkaXNhYmxlZFwiLFwiZGlzYWJsZWRcIik7XG5cdFx0bGV0IHJlc3VsdCA9IHRoaXMuc3VwZXJTZWFyY2hMaW5lRm9ybS5xdWVyeVNlbGVjdG9yKHRoaXMuYmFzZUNsYXNzU2VsZWN0b3IrXCJfX3Jlc3VsdFwiKTtcblx0XHRyZXN1bHQgJiYgdGhpcy5zdXBlclNlYXJjaExpbmVGb3JtLnJlbW92ZUNoaWxkKHJlc3VsdCk7XG5cdFx0Ly9jb25zb2xlLmxvZyh0aGlzLnN1cGVyU2VhcmNoTGluZUlucHV0LnZhbHVlKTtcblx0fVxuXG5cdHN1cGVyU2VhcmNoTGluZVN1Ym1pdChlKXtcblx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0bGV0IFhIUiA9IChcIm9ubG9hZFwiIGluIG5ldyBYTUxIdHRwUmVxdWVzdCgpKSA/IFhNTEh0dHBSZXF1ZXN0IDogWERvbWFpblJlcXVlc3Q7XG5cdFx0bGV0IHIgPSBuZXcgWEhSKCk7XG5cdFx0bGV0IGRhdGEgPSB7XG5cdFx0XHRcImZvcm1JZFwiOiB0aGlzLmlkLFxuXHRcdFx0XCJxdWVyeVwiOiB0aGlzLnN1cGVyU2VhcmNoTGluZUlucHV0LnZhbHVlXG5cdFx0fTtcblx0XHRyLm9wZW4oXCJQT1NUXCIsdGhpcy5yZW1vdGUpO1xuXHRcdHIub25sb2FkID0gKHJlc3BvbnNlKSA9PiB7XG5cdFx0XHRjb25zb2xlLmxvZyhyZXNwb25zZSk7XG5cdFx0fTtcblx0XHRyLm9uZXJyb3IgPSAoZXJyb3IpID0+IHtcblx0XHRcdGNvbnNvbGUubG9nKFwi0J7RiNC40LHQutCwOiBcIiwgZXJyb3IpO1xuXHRcdH07XG5cdFx0ci5zZW5kKGRhdGEpO1xuXHR9XG5cblx0c3VwZXJTZWFyY2hMaW5lUmVzdWx0R2VuZXJhdG9yKHByb3RvY29sLCBkb21haW4sIHF1ZXJ5KXtcblx0XHRsZXQgaW5wdXRXaWR0aCA9IHRoaXMuc3VwZXJTZWFyY2hMaW5lSW5wdXQub2Zmc2V0V2lkdGg7XG5cblx0XHQvLyDQl9Cw0L/QuNGB0YvQstCw0LXQvCDRgtC10LrRgdGCINCyINCx0LvQvtC60Lgg0YDQtdC30YPQu9GM0YLQsNGC0LAg0Lgg0YHRh9C40YLQsNC10Lwg0LjRhSDRiNC40YDQuNC90YNcblx0XHR0aGlzLmxpbmtUZXh0RWwxLmlubmVySFRNTCA9IHByb3RvY29sK2RvbWFpbitxdWVyeTtcblx0XHRsZXQgbGlua1N0cjFXaWR0aCA9IHRoaXMuc3RyaW5nV2lkdGhJblBYKHRoaXMubGlua1RleHRFbDEpO1xuXHRcdHRoaXMubGlua1RleHRFbDIuaW5uZXJIVE1MID0gZG9tYWluO1xuXHRcdGxldCBsaW5rU3RyMldpZHRoID0gdGhpcy5zdHJpbmdXaWR0aEluUFgodGhpcy5saW5rVGV4dEVsMik7XG5cdFx0dGhpcy5saW5rVGV4dEVsMy5pbm5lckhUTUwgPSBkb21haW4rcXVlcnk7XG5cdFx0bGV0IGxpbmtTdHIzV2lkdGggPSB0aGlzLnN0cmluZ1dpZHRoSW5QWCh0aGlzLmxpbmtUZXh0RWwzKTtcblxuXHRcdFxuXHRcdFxuXHRcdGxldCBzdXBlclNlYXJjaExpbmVSZXN1bHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcblx0XHRzdXBlclNlYXJjaExpbmVSZXN1bHQuc2V0QXR0cmlidXRlKCdjbGFzcycsIHRoaXMuYmFzZUNsYXNzK1wiX19yZXN1bHRcIik7XG5cdFx0bGV0IGhlbHBlckZpeGVkQ2xhc3MgPSBgJHt0aGlzLmJhc2VDbGFzc31fX2hlbHBlci0tZml4ZWRgO1xuXG5cdFx0KGlucHV0V2lkdGggLSB0aGlzLmhlbHBlclN0cjFXaWR0aCA8IGxpbmtTdHIxV2lkdGgpID8gdGhpcy5oZWxwZXJFbDEuY2xhc3NMaXN0LmFkZChoZWxwZXJGaXhlZENsYXNzKSA6IHRoaXMuaGVscGVyRWwxLmNsYXNzTGlzdC5yZW1vdmUoaGVscGVyRml4ZWRDbGFzcyk7XG5cdFx0KGlucHV0V2lkdGggLSB0aGlzLmhlbHBlclN0cjJXaWR0aCA8IGxpbmtTdHIyV2lkdGgpID8gdGhpcy5oZWxwZXJFbDIuY2xhc3NMaXN0LmFkZChoZWxwZXJGaXhlZENsYXNzKSA6IHRoaXMuaGVscGVyRWwyLmNsYXNzTGlzdC5yZW1vdmUoaGVscGVyRml4ZWRDbGFzcyk7XG5cdFx0KGlucHV0V2lkdGggLSB0aGlzLmhlbHBlclN0cjNXaWR0aCA8IGxpbmtTdHIzV2lkdGgpID8gdGhpcy5oZWxwZXJFbDMuY2xhc3NMaXN0LmFkZChoZWxwZXJGaXhlZENsYXNzKSA6IHRoaXMuaGVscGVyRWwzLmNsYXNzTGlzdC5yZW1vdmUoaGVscGVyRml4ZWRDbGFzcyk7XG5cblxuXHRcdGxldCBzdXBlclNlYXJjaExpbmVJdGVtcyA9XHRcblx0XHRcdGA8ZGl2IGNsYXNzPVwiJHt0aGlzLmJhc2VDbGFzc31fX2l0ZW1cIj5cblx0XHRcdFx0PGEgaHJlZj1cIiR7dGhpcy5yZW1vdGV9P3N1Z2dlc3Rpb25UeXBlPXBocmFzZSZxdWVyeT0ke3Byb3RvY29sK2RvbWFpbitxdWVyeX1cIiB0YXJnZXQ9XCJfYmxhbmtcIiBjbGFzcz1cIiR7dGhpcy5iYXNlQ2xhc3N9X19saW5rXCI+XG5cdFx0XHRcdFx0JHt0aGlzLm5vZGVUb1N0cmluZyh0aGlzLmxpbmtUZXh0RWwxKX1cblx0XHRcdFx0XHQke3RoaXMubm9kZVRvU3RyaW5nKHRoaXMuaGVscGVyRWwxKX1cblx0XHRcdFx0PC9hPlxuXHRcdFx0XHRcblx0XHRcdDwvZGl2PlxuXHRcdFx0PGRpdiBjbGFzcz1cIiR7dGhpcy5iYXNlQ2xhc3N9X19pdGVtXCI+XG5cdFx0XHRcdDxhIGhyZWY9XCIke3RoaXMucmVtb3RlfT9zdWdnZXN0aW9uVHlwZT1kb21haW4mcXVlcnk9JHtkb21haW59XCIgdGFyZ2V0PVwiX2JsYW5rXCIgY2xhc3M9XCIke3RoaXMuYmFzZUNsYXNzfV9fbGlua1wiPlxuXHRcdFx0XHRcdCR7dGhpcy5ub2RlVG9TdHJpbmcodGhpcy5saW5rVGV4dEVsMil9XG5cdFx0XHRcdFx0JHt0aGlzLm5vZGVUb1N0cmluZyh0aGlzLmhlbHBlckVsMil9XG5cdFx0XHRcdDwvYT5cblx0XHRcdDwvZGl2PlxuXHRcdFx0PGRpdiBjbGFzcz1cIiR7dGhpcy5iYXNlQ2xhc3N9X19pdGVtXCI+XG5cdFx0XHRcdDxhIGhyZWY9XCIke3RoaXMucmVtb3RlfT9zdWdnZXN0aW9uVHlwZT11cmwmcXVlcnk9JHtkb21haW4rcXVlcnl9XCIgdGFyZ2V0PVwiX2JsYW5rXCIgY2xhc3M9XCIke3RoaXMuYmFzZUNsYXNzfV9fbGlua1wiPlxuXHRcdFx0XHRcdCR7dGhpcy5ub2RlVG9TdHJpbmcodGhpcy5saW5rVGV4dEVsMyl9XG5cdFx0XHRcdFx0JHt0aGlzLm5vZGVUb1N0cmluZyh0aGlzLmhlbHBlckVsMyl9XG5cdFx0XHRcdDwvYT5cblx0XHRcdDwvZGl2PmA7XG5cdFx0c3VwZXJTZWFyY2hMaW5lUmVzdWx0LmlubmVySFRNTCA9IHN1cGVyU2VhcmNoTGluZUl0ZW1zO1xuXHRcdHJldHVybiBzdXBlclNlYXJjaExpbmVSZXN1bHQ7XG5cdH1cblxuXHRzdXBlclNlYXJjaExpbmVJbnB1dEhhbmRsZXIoZSl7XG5cdFx0bGV0IHZhbHVlID0gZS50YXJnZXQudmFsdWU7XG5cdFx0bGV0IHJlc3VsdCA9IHRoaXMuc3VwZXJTZWFyY2hMaW5lRm9ybS5xdWVyeVNlbGVjdG9yKHRoaXMuYmFzZUNsYXNzU2VsZWN0b3IrXCJfX3Jlc3VsdFwiKTtcblx0XHRyZXN1bHQgJiYgdGhpcy5zdXBlclNlYXJjaExpbmVGb3JtLnJlbW92ZUNoaWxkKHJlc3VsdCk7XG5cdFx0aWYodmFsdWUgIT09IG51bGwgJiYgdmFsdWUgIT09IFwiXCIpe1xuXHRcdFx0dGhpcy5zdXBlclNlYXJjaExpbmVSZXNldC5jbGFzc0xpc3QucmVtb3ZlKCdoaWRkZW4nKTtcblx0XHRcdHRoaXMuc3VwZXJTZWFyY2hMaW5lQnV0dG9uLnJlbW92ZUF0dHJpYnV0ZShcImRpc2FibGVkXCIpO1xuXHRcdFx0aWYodGhpcy5wYXJzZVVybCh2YWx1ZSkpe1xuXHRcdFx0XHRsZXQgcmVzdWx0ID0gdmFsdWUubWF0Y2godGhpcy51cmxQYXR0ZXJuKTtcblx0XHRcdFx0bGV0IHByb3RvY29sID0gcmVzdWx0WzFdO1xuXHRcdFx0XHRsZXQgZG9tYWluID0gcmVzdWx0WzJdO1xuXHRcdFx0XHRsZXQgcXVlcnkgPSByZXN1bHRbM107XG5cdFx0XHRcdGxldCBzdXBlclNlYXJjaExpbmVSZXN1bHQgPSB0aGlzLnN1cGVyU2VhcmNoTGluZVJlc3VsdEdlbmVyYXRvcihwcm90b2NvbCxkb21haW4scXVlcnkpO1xuXHRcdFx0XHRjb25zb2xlLmxvZyh0cnVlKTtcblx0XHRcdFx0dGhpcy5zdXBlclNlYXJjaExpbmVGb3JtLmFwcGVuZENoaWxkKHN1cGVyU2VhcmNoTGluZVJlc3VsdCk7XG5cdFx0XHR9XHRcdFxuXHRcdH1lbHNle1xuXHRcdFx0dGhpcy5zdXBlclNlYXJjaExpbmVSZXNldC5jbGFzc0xpc3QuYWRkKCdoaWRkZW4nKTtcblx0XHRcdHRoaXMuc3VwZXJTZWFyY2hMaW5lQnV0dG9uLnNldEF0dHJpYnV0ZShcImRpc2FibGVkXCIsXCJkaXNhYmxlZFwiKTtcblx0XHR9XHRcblx0fVxuXG5cdHN0cmluZ1dpZHRoSW5QWChlbCkge1xuXHQgIC8vINC00L7Qv9C+0LvQvdC40YLQtdC70YzQvdGL0LUg0YHRgtC40LvQuCDQtNC70Y8g0LrQu9C+0L3QsCwg0YfRgtC+INCx0Ysg0LzQuNGAINC90LUg0LfQsNC80LXRgtC40Lsg0YfRg9C00LAsINC4INGA0LDQt9C80LXRgNGLINC+0YLQvtCx0YDQsNC20LDQu9C40YHRjCDQutC+0YDRgNC10LrRgtC90L5cblx0ICBsZXQgaGlkZGVuU3R5bGUgPSBcImxlZnQ6LTEwMDAwcHg7dG9wOi0xMDAwMHB4O2hlaWdodDphdXRvO3dpZHRoOmF1dG87cG9zaXRpb246YWJzb2x1dGU7XCI7XG5cblx0ICAvLyDRgdC+0LfQtNCw0LXQvCBib3gg0Y3Qu9C10LzQtdC90YIgXG5cdCAgLy8g0LTQu9GPINC60LvQvtC90LjRgNC+0LLQsNC90LjRjyDRgdC+0LTQtdGA0LbQuNC80L7Qs9C+INC40Lcg0L3QsNGI0LXQs9C+INC40YHRhdC+0LTQvdC+0LPQviBpbmxpbmUg0LHQu9C+0LrQsFxuXHQgIGxldCBjbG9uZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuXHQgIFxuXHQgIC8vINCyINC+0LHRj9C30LDRgtC10LvRjNC90L7QvCDQv9C+0YDRj9C00LrQtSDQutC+0L/QuNGA0YPQtdC8INGB0YLQuNC70Lgg0YEg0LjRgdGF0L7QtNC90L7Qs9C+INGN0LvQtdC80LXQvdGC0LAsIFxuXHQgIC8vINGH0YLQviDQsdGLINGA0LDQt9C80LXRgNGLINGB0L7QvtGC0LLQtdGC0YHRgtCy0L7QstCw0LvQuCDQuNGB0YXQvtC00L3QuNC60YMuXG5cdCAgZm9yIChsZXQgaSBpbiBlbC5zdHlsZSkge1xuXHQgICAgdHJ5IHtcblx0ICAgICAgaWYgKChlbC5zdHlsZVtpXSAhPSAnJykgJiYgKGVsLnN0eWxlW2ldLmluZGV4T2YoXCI6XCIpID4gMCkpIHtcblx0ICAgICAgICBjbG9uZS5zdHlsZVtpXSA9IGVsLnN0eWxlW2ldO1xuXHQgICAgICB9XG5cdCAgICB9IGNhdGNoIChlKSB7fVxuXHQgIH1cblx0ICBcblx0ICAvLyDRg9GB0YLQsNC90LDQstC70LjQstCw0LXQvCDRgdGC0LjQu9C4INGDINC60LvQvtC90LAsINC00LDQsdGLINC+0L0g0L3QtSDQvNC+0LfQvtC70LjQuyDQs9C70LDQty4gXG5cdCAgLy8g0KPRh9C40YLRi9Cy0LDQtdC8LCDRh9GC0L4gSUUg0L3QtSDQv9C+0LfQstC+0LvRj9C10YIg0L3QsNC/0YDRj9C80YPRjiDRg9GB0YLQsNC90LDQstC70LjQstCw0YLRjCDQt9C90LDRh9C10L3QuNC1INCw0YLRgtGA0LjQsdGD0YLQsCBzdHlsZVxuXHQgIGRvY3VtZW50LmFsbCA/IGNsb25lLnN0eWxlLnNldEF0dHJpYnV0ZSgnY3NzVGV4dCcsIGhpZGRlblN0eWxlKSA6IGNsb25lLnNldEF0dHJpYnV0ZSgnc3R5bGUnLCBoaWRkZW5TdHlsZSk7XG5cblx0ICAvLyDQn9C10YDQtdC90L7RgdC40Lwg0YHQvtC00LXRgNC20LjQvNC+0LUuINCQ0LrQutGD0YDQsNGC0L3Qvi5cblx0ICBjbG9uZS5pbm5lckhUTUwgPSBlbC5pbm5lckhUTUxcblx0ICBcblx0ICAvLyDQlNC+0LHQsNCy0LvRj9C10Lwg0LrQu9C+0L0g0LIg0LrQvtGA0L3QtdCy0L7QuSDQtNC+0LrRg9C80LXQvdGCLiBcblx0ICAvLyDQotCw0LosINC90LAg0LLRgdGP0LrQuNC5INC/0L7QttCw0YDQvdGL0Lkg0LIgcGFyZW50LCDQsCDRgtC+INCy0LTRgNGD0LMg0Y3Qu9C10LzQtdC90YIg0LLQvdGD0YLRgNC4IGlmcmFtZT9cblx0ICBwYXJlbnQuZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChjbG9uZSk7XG5cdCAgXG5cdCAgLy8g0JfQsNCx0LjQstCw0LXQvCDQt9Cw0LLQtdGC0L3QvtC1LlxuXHQgIGxldCB3aWR0aCA9IGNsb25lLmNsaWVudFdpZHRoO1xuXHQgIGNvbnNvbGUubG9nKHdpZHRoKTtcblx0ICBcblx0ICAvLyAuLi7QuCDRgtGD0YIg0LbQtSDRg9C00LDQu9GP0LXQvFxuXHQgIHBhcmVudC5kb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKGNsb25lKTtcblxuXHQgIC8vINCS0L7RgiDRgdC+0LHRgdGC0LLQtdC90L3QviDQs9C+0LLQvtGA0Y8g0Lgg0LLRgdC1LlxuXHQgIHJldHVybiB3aWR0aDtcblx0fVxuXG5cdG5vZGVUb1N0cmluZyhub2RlKXtcblx0XHRsZXQgdG1wTm9kZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG5cdFx0dG1wTm9kZS5hcHBlbmRDaGlsZChub2RlLmNsb25lTm9kZSh0cnVlKSk7XG5cdFx0bGV0IHN0ciA9IHRtcE5vZGUuaW5uZXJIVE1MO1xuXHRcdHRtcE5vZGUgPSBub2RlID0gbnVsbDtcblx0XHRyZXR1cm4gc3RyO1xuXHR9XG59XG5cblxuY29uc3QgaW5pdCA9ICgpID0+IHtcblx0bGV0IHN1cGVyU2VhcmNoTGluZXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuc3VwZXItc2VhcmNoLWxpbmUnKTtcblx0bGV0IGkgPSAwO1xuXHRmb3IobGV0IHN1cGVyU2VhcmNoTGluZSBvZiBzdXBlclNlYXJjaExpbmVzKSB7XG5cdFx0c3VwZXJTZWFyY2hMaW5lLnNldEF0dHJpYnV0ZSgnaWQnLFwic3VwZXJTZWFjaExpbmVcIitpKyspO1xuXHRcdG5ldyBTdXBlclNlYXJjaExpbmUoc3VwZXJTZWFyY2hMaW5lKTtcblx0fVxufVxuXG4oZnVuY3Rpb24oKXtcblx0ZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGluaXQpO1xuXHRcbn0pO1xuIl19
